<!doctype html>
<html>
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC&display=swap" rel="stylesheet">
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <title>LoGaRT Image Classification</title>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='upload.js') }}"></script>
    <script type="text/javascript">
        $(document).ready(function (e) {
            $('#upload').on('click', function () {
                var form_data = new FormData();
                var ins = document.getElementById('multiFiles').files.length;
                 
                if(ins == 0) {
                    $('#msg').html('<span style="color:red">Select at least one file</span>');
                    return;
                }
                 
                for (var x = 0; x < ins; x++) {
                    form_data.append("files[]", document.getElementById('multiFiles').files[x]);
                }
                 
                $.ajax({
                    url: '/upload', // point to server-side URL
                    dataType: 'json', // what to expect back from server
                    cache: false,
                    contentType: false,
                    processData: false,
                    data: form_data,
                    type: 'post',
                    success: function (response) { // display success response
                        $('#msg').html('');
                        $.each(response, function (key, data) {                         
                            if(key !== 'message') {
                                $('#msg').append(key + ' -> ' + data + '<br/>');
                            } else {
                                $('#msg').append(data + '<br/>');
                            }
                        })
                    },
                    error: function (response) {
                        $('#msg').html(response.message); // display error response
                    }
                });
            });
        });
    </script>
</head>
<body>
    <div lang="en" class="wrapper">
    <h1>LoGaRT Image Classification</h1>
    <h3>Select file to upload</h3>
    <dl>
        <p>
            <label for="multiFiles" class="custom-file-upload">
                Choose File
            </label>
            <input type="file" style="font-family:'Noto Serif TC',serif" id="multiFiles" name="files[]" multiple="multiple" onchange="readURL(this);"/>
            <button id="upload">Predict</button>
            <p><img id="blah" src="#" alt="Select your image" onerror="this.style.display='none'" /></p>
            <h3>Results:</h3>
            <p id="msg"></p>
        </p>
    </dl>
    <p id="result">{{data}}</p>
    </div>

    <div lang="de" class="wrapper">
        <h1>LoGaRT Image Classification</h1>
        <h3>Datei zum Hochladen auswählen</h3>
        <dl>
            <p>
                <label for="multiFiles" class="custom-file-upload">
                    Datei auswählen
                </label>
                <input type="file" style="font-family:'Noto Serif TC',serif" id="multiFiles" name="files[]" multiple="multiple" onchange="readURL(this);"/>
                <button id="upload">Vorhersagen</button>
                <p><img id="blah" src="#" alt="Select your image" onerror="this.style.display='none'" /></p>
                <h3>Ergebnisse:</h3>
                <p id="msg"></p>
            </p>
        </dl>
        <p id="result">{{data}}</p>
    </div>
</body>